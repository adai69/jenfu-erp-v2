(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19494,e=>{"use strict";var t=e.i(43476),s=e.i(22016),l=e.i(71645);e.i(36180);var a=e.i(98925);e.i(61086);var d=e.i(27215),r=e.i(74503),o=e.i(9348),i=e.i(47821),c=e.i(27379),n=e.i(84616);let x={keyword:"",type:"all",category:"all",status:"all"},m=e=>e.split(/[,\s]+/).map(e=>e.trim()).filter(Boolean),u=(e,t)=>({code:"",name:"",spec:"",model:"",brandCode:"",type:"PS",categoryCode:e??i.materialCategories[0]?.code??"",unitCode:i.units[0]?.code??"",defaultWarehouseCode:"",preferredSupplierCode:"",purchaseMethodCode:"",purchaseLeadTimeDays:"",stdCost:"",currency:"TWD",status:"active",isStocked:!0,description:"",note:"",searchKeywords:"",baseCode:t,isVariant:!!t}),p=[{label:"標準 (PS)",value:"PS"},{label:"訂製 (PM)",value:"PM"},{label:"其他 (PO)",value:"PO"}];function h(){let e,h,b,[f,j]=(0,l.useState)(i.materials),[y,N]=(0,l.useState)(i.materialCategories),[v,g]=(0,l.useState)(i.units),[C,w]=(0,l.useState)(i.warehouses),[S,k]=(0,l.useState)(i.suppliers),[P,D]=(0,l.useState)(i.purchaseMethods),[T,M]=(0,l.useState)(i.brands),[U,B]=(0,l.useState)(x),[L,W]=(0,l.useState)(x),[I,A]=(0,l.useState)(!1),[K,$]=(0,l.useState)(!1),[V,R]=(0,l.useState)(null),[E,z]=(0,l.useState)(()=>u(i.materialCategories[0]?.code)),[F,O]=(0,l.useState)(!1),[_,q]=(0,l.useState)(null),[X,G]=(0,l.useState)(null),[H,J]=(0,l.useState)(!1),[Q,Y]=(0,l.useState)(null),[Z,ee]=(0,l.useState)([]),[et,es]=(0,l.useState)(!1),[el,ea]=(0,l.useState)(0),[ed,er]=(0,l.useState)(!1),[eo,ei]=(0,l.useState)({title:"",description:"",tags:"",isPrimary:!1}),[ec,en]=(0,l.useState)(null),[ex,em]=(0,l.useState)(null),[eu,ep]=(0,l.useState)(null),[eh,eb]=(0,l.useState)(!1),[ef,ej]=(0,l.useState)(null),{can:ey}=(0,n.usePermission)(),eN=ey("materials","view"),ev=ey("materials","create"),eg=ey("materials","update"),eC=ey("files","view"),ew=ey("files","create");(0,l.useEffect)(()=>{(async()=>{try{let[e,t,s,l,d,o]=await Promise.all([(0,a.getDocs)((0,a.collection)(r.db,"materialCategories")),(0,a.getDocs)((0,a.collection)(r.db,"units")),(0,a.getDocs)((0,a.collection)(r.db,"warehouses")),(0,a.getDocs)((0,a.collection)(r.db,"suppliers")),(0,a.getDocs)((0,a.collection)(r.db,"purchaseMethods")),(0,a.getDocs)((0,a.collection)(r.db,"brands"))]),c=e.docs.length>0?e.docs.map(e=>{let t=e.data();return{...t,code:t.code??e.id}}):i.materialCategories;N(c);let n=t.docs.length>0?t.docs.map(e=>({...e.data()})):i.units;g(n);let x=s.docs.length>0?s.docs.map(e=>({...e.data()})):i.warehouses;w(x);let m=l.docs.length>0?l.docs.map(e=>({...e.data()})):i.suppliers;k(m);let u=d.docs.length>0?d.docs.map(e=>{let t=e.data();return{...t,code:t.code??e.id,status:t.status??"active",category:t.category??"general"}}):i.purchaseMethods;D(u);let p=o.docs.length>0?o.docs.map(e=>{let t=e.data();return{...t,code:t.code??e.id,status:t.status??"active"}}):i.brands;M(p)}catch(e){console.error("Failed to load reference data for materials",e)}})()},[]),(0,l.useEffect)(()=>{(async()=>{try{let e=(await (0,a.getDocs)((0,a.collection)(r.db,"materials"))).docs.map(e=>{var t,s;let l,a;return t=e.data(),s=e.id,a=(l=t.brand??void 0)&&i.brands.find(e=>e.name===l)?.code,{code:t.code??s,name:t.name??"",spec:t.spec,model:t.model,brandCode:t.brandCode??a??void 0,type:t.type??"PS",categoryCode:t.categoryCode??"",unitCode:t.unitCode??"",defaultWarehouseCode:t.defaultWarehouseCode,preferredSupplierCode:t.preferredSupplierCode,purchaseMethodCode:t.purchaseMethodCode,purchaseLeadTimeDays:"number"==typeof t.purchaseLeadTimeDays?t.purchaseLeadTimeDays:void 0,stdCost:"number"==typeof t.stdCost?t.stdCost:void 0,currency:t.currency,status:t.status??"active",isStocked:!!t.isStocked,description:t.description,note:t.note,searchKeywords:Array.isArray(t.searchKeywords)?t.searchKeywords:void 0,baseCode:t.baseCode,variantNo:t.variantNo,isVariant:!0===t.isVariant||!!t.variantNo,createdByUserId:t.createdByUserId,createdByEmployeeCode:t.createdByEmployeeCode,createdByName:t.createdByName}});e.length&&j(t=>{let s=new Map(t.map(e=>[e.code,e]));return e.forEach(e=>s.set(e.code,e)),Array.from(s.values())})}catch(e){console.error("Failed to load materials",e)}})()},[]),(0,l.useEffect)(()=>{if(!I&&!K)return;let e=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=e}},[I,K]),(0,l.useEffect)(()=>{if(!K||!Q||!eC)return void ee([]);let e=!0;return(async()=>{es(!0);try{let t=(0,a.query)((0,a.collection)(r.db,"files"),(0,a.where)("targetModule","==","materials"),(0,a.where)("entityId","==",Q.code)),s=await (0,a.getDocs)(t),l=[];for(let e of s.docs){let t=e.data();if(t.deletedAt)continue;let s="string"==typeof t.mimeType?t.mimeType:"application/octet-stream",a={id:e.id,targetModule:"materials",entityId:t.entityId??Q.code,storagePath:t.storagePath??"",fileName:t.fileName??e.id,mimeType:s,size:"number"==typeof t.size?t.size:void 0,title:t.title??void 0,description:t.description??void 0,tags:Array.isArray(t.tags)?t.tags:[],isPrimary:!0===t.isPrimary,orderIndex:"number"==typeof t.orderIndex?t.orderIndex:void 0,createdAt:t.createdAt,createdByUid:t.createdByUid??void 0,createdByName:t.createdByName??void 0,deletedAt:void 0};if(a.storagePath&&s.startsWith("image/"))try{a.downloadURL=await (0,d.getDownloadURL)((0,d.ref)(r.storage,a.storagePath))}catch(e){console.warn("Failed to load material preview",e)}l.push(a)}l.sort((e,t)=>{if(e.isPrimary!==t.isPrimary)return e.isPrimary?-1:1;let s=e.orderIndex??e.createdAt?.toDate().getTime()??0;return(t.orderIndex??t.createdAt?.toDate().getTime()??0)-s}),e&&ee(l)}catch(t){console.error("Failed to load material files",t),e&&ee([])}finally{e&&es(!1)}})(),()=>{e=!1}},[K,Q,eC,el]);let eS=(0,l.useMemo)(()=>new Map(P.map(e=>[e.code,e.name])),[P]),ek=(0,l.useMemo)(()=>P.filter(e=>"active"===e.status),[P]),eP=(0,l.useMemo)(()=>new Map(T.map(e=>[e.code,e])),[T]),eD=(0,l.useMemo)(()=>T.filter(e=>"active"===e.status),[T]),eT=(0,l.useMemo)(()=>f.filter(e=>{let t=L.keyword.trim().toLowerCase(),s=e.brandCode?eP.get(e.brandCode)?.name??e.brandCode:"",l=!t||[e.code,e.name,e.spec??"",e.model??"",s,e.description??"",e.searchKeywords?.join(" ")??"",e.purchaseMethodCode??""].join(" ").toLowerCase().includes(t),a="all"===L.type||e.type===L.type,d="all"===L.category||e.categoryCode===L.category,r="all"===L.status||e.status===L.status;return l&&a&&d&&r}),[L,f,eP]),eM=async e=>{let t=f.filter(t=>(t.baseCode??t.code)===e&&t.variantNo).map(e=>Number.parseInt(e.variantNo??"0",10)).filter(e=>!Number.isNaN(e)),s=(t.length?Math.max(...t)+1:1).toString().padStart(5,"0"),l=`${e}-${s}`;f.find(e=>e.code===l)?q("生成的子料號已存在，請稍後再試或手動調整。"):z(t=>({...t,code:l,baseCode:e,isVariant:!0,variantNo:s}))},eU=()=>{A(!1),z(u(y[0]?.code)),q(null),R(null),J(!1),er(!1),en(null),em(null),ep(null)},eB=async e=>{if(e.preventDefault(),!V)return void em("請先儲存此物料後再上傳檔案。");if(!ec||0===ec.length)return void em("請選擇至少一個檔案");eb(!0),em(null);try{await (0,o.uploadFilesForEntity)({module:"materials",entityId:V,files:Array.from(ec),metadata:{title:eo.title,description:eo.description,tags:m(eo.tags),setPrimary:eo.isPrimary},createdBy:{uid:r.auth.currentUser?.uid??null,name:r.auth.currentUser?.email??r.auth.currentUser?.displayName??"system"}}),ep("已完成檔案上傳"),en(null),ei(e=>({...e,isPrimary:!1})),ea(e=>e+1)}catch(e){console.error("Failed to upload material files",e),em("上傳失敗，請稍後再試。")}finally{eb(!1)}},eL=()=>{er(!1),en(null),em(null),ep(null)},eW=(e,t)=>{z(s=>({...s,[e]:t}))},eI=async e=>{if(!V&&!H&&!E.isVariant)try{let t=await (0,c.issueSequence)("PS"===e?"PART_PS":"PM"===e?"PART_PM":"PART_PO");z(e=>({...e,code:t.value}))}catch{q("取得料號時發生問題，請稍後再試。")}},eA=async e=>{z(t=>({...t,type:e})),H||V||await eI(e)},eK=!V&&"PS"===E.type,e$=async e=>{J(e),e?z(e=>({...e,code:"PS-0000A"})):await eI(E.type)},eV=async e=>{if(e.preventDefault(),F)return;let t=E.name.trim(),s=E.code.trim();if(!s)return void q("料號取得失敗，請重新選擇型態或重新整理頁面。");if(!t)return void q("請輸入品名");if(!E.categoryCode)return void q("請選擇物料分類");if(!E.unitCode)return void q("請選擇計量單位");let l=""===E.purchaseLeadTimeDays.trim()?void 0:Number.parseInt(E.purchaseLeadTimeDays,10);if(void 0!==l&&Number.isNaN(l))return void q("採購前置天數需為數字");let d=""===E.stdCost.trim()?void 0:Number.parseFloat(E.stdCost);if(void 0!==d&&Number.isNaN(d))return void q("參考成本需為數字");let o=E.model.trim(),i=E.brandCode.trim(),c=E.description.trim(),n=E.purchaseMethodCode.trim(),x=m(E.searchKeywords);O(!0),q(null);let u=r.auth.currentUser,p=u?.displayName??u?.email??"system",h={code:s,name:t,spec:E.spec.trim(),model:o||null,brandCode:i||null,type:E.type,categoryCode:E.categoryCode,unitCode:E.unitCode,defaultWarehouseCode:E.defaultWarehouseCode||null,preferredSupplierCode:E.preferredSupplierCode||null,purchaseMethodCode:n||null,purchaseLeadTimeDays:l??null,stdCost:d??null,currency:E.currency.trim()||"TWD",status:E.status,isStocked:E.isStocked,description:c||null,note:E.note.trim(),searchKeywords:x,baseCode:E.isVariant&&E.baseCode?E.baseCode:E.isVariant?s.split("-")[0]:null,variantNo:E.isVariant&&s.includes("-")?s.split("-").pop():null,isVariant:E.isVariant??!1,updatedAt:(0,a.serverTimestamp)(),...V?{}:{createdAt:(0,a.serverTimestamp)(),createdByUserId:u?.uid??null,createdByName:p}};try{await (0,a.setDoc)((0,a.doc)(r.db,"materials",s),h,{merge:!0}),j(e=>{let a=e.filter(e=>e.code!==s);return a.push({code:s,name:t,spec:E.spec.trim()||void 0,model:o||void 0,brandCode:i||void 0,type:E.type,categoryCode:E.categoryCode,unitCode:E.unitCode,defaultWarehouseCode:E.defaultWarehouseCode||void 0,preferredSupplierCode:E.preferredSupplierCode||void 0,purchaseMethodCode:n||void 0,purchaseLeadTimeDays:l,stdCost:d,currency:h.currency,status:E.status,isStocked:E.isStocked,description:c||void 0,note:E.note.trim()||void 0,searchKeywords:x.length?x:void 0,baseCode:h.baseCode??void 0,variantNo:h.variantNo??void 0,isVariant:h.isVariant??!1,createdByName:V?e.find(e=>e.code===s)?.createdByName:p,createdByUserId:V?e.find(e=>e.code===s)?.createdByUserId:u?.uid??void 0}),a}),G(V?`已更新 ${s}`:`已新增 ${s}`),eU()}catch(e){console.error("Failed to save material",e),q("儲存物料時發生錯誤，請稍後再試。")}finally{O(!1)}},eR=e=>y.find(t=>t.code===e)?.name??e,eE=e=>v.find(t=>t.code===e)?.name??e,ez=e=>e?C.find(t=>t.code===e)?.name??e:"—",eF=Z.find(e=>e.isPrimary),eO=Z.filter(e=>!e.isPrimary),e_=V?f.find(e=>e.code===V):null,eq=r.auth.currentUser,eX=e_?e_.createdByName??"未記錄":eq?.displayName??eq?.email??"儲存後自動記錄";return(0,t.jsxs)("div",{className:"space-y-6",children:[K&&Q&&(0,t.jsx)("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-slate-900/50 px-4 py-8",children:(0,t.jsxs)("div",{className:"w-full max-w-3xl max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-teal-600",children:"View"}),(0,t.jsxs)("h2",{className:"text-xl font-semibold text-slate-900",children:["檢視物料 ",Q.code]})]}),(0,t.jsx)("button",{onClick:()=>{$(!1),Y(null),ee([])},className:"rounded-full px-3 py-1 text-sm text-slate-500 hover:bg-slate-100",children:"關閉"})]}),(0,t.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"基本資料"}),(0,t.jsxs)("div",{className:"mt-3 grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"料號"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.code})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"物料型態"}),(0,t.jsx)("p",{className:"mt-1 inline-flex items-center rounded-full bg-slate-900/5 px-3 py-1 text-xs font-semibold text-slate-700",children:(e=Q.type,p.find(t=>t.value===e)?.label??e)})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"品名"}),(0,t.jsx)("p",{className:"mt-1 text-base font-semibold text-slate-900",children:Q.name})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"規格"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-700",children:Q.spec?.trim()||"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"型號"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.model||"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"品牌"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:(e=>{if(!e)return"—";let t=eP.get(e);return t?t.code?`${t.name} (${t.code})`:t.name:e})(Q.brandCode)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"狀態"}),(0,t.jsx)("span",{className:`mt-1 inline-flex rounded-full px-3 py-1 text-xs font-semibold ${"active"===Q.status?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:"active"===Q.status?"使用中":"停用"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"庫存管控"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.isStocked?"納入":"不納入"})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"分類與供應"}),(0,t.jsxs)("div",{className:"mt-3 grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"分類"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:eR(Q.categoryCode)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"計量單位"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:eE(Q.unitCode)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"預設倉庫"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:ez(Q.defaultWarehouseCode)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"首選供應商"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:(h=Q.preferredSupplierCode)?S.find(e=>e.code===h)?.name??h:"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"採購方式"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:(b=Q.purchaseMethodCode)?eS.get(b)??b:"—"})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"採購資訊"}),(0,t.jsxs)("div",{className:"mt-3 grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"採購前置天數"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.purchaseLeadTimeDays??"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"參考成本"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:void 0!==Q.stdCost?`${Q.currency??"TWD"} ${Q.stdCost}`:"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"備註"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-700",children:Q.note?.trim()||"—"})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"說明與關鍵字"}),(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"說明 / 附件備註"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-700",children:Q.description?.trim()||"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"檢索用關鍵字"}),(0,t.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:Q.searchKeywords?.length?Q.searchKeywords.map(e=>(0,t.jsx)("span",{className:"rounded-full bg-slate-900/5 px-3 py-1 text-xs font-semibold text-slate-600",children:e},`${Q.code}-${e}`)):(0,t.jsx)("span",{className:"text-sm text-slate-500",children:"—"})})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"子料資訊"}),(0,t.jsxs)("div",{className:"mt-3 grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"是否為子料"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.isVariant?"是":"否"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"母料號"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.baseCode??"—"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"子料編號"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.variantNo??"—"})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"系統資訊"}),(0,t.jsxs)("div",{className:"mt-3 grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"建碼人"}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-slate-900",children:Q.createdByName||"未記錄"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"建碼 UID"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:Q.createdByUserId||"—"})]})]})]}),eC&&(0,t.jsxs)("section",{className:"rounded-2xl border border-slate-100 p-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"檔案 / 圖片"}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"與此料號關聯的附件與照片"})]}),(0,t.jsx)(s.default,{href:`/master/files?module=materials&entityId=${encodeURIComponent(Q.code)}`,className:"rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-700 transition hover:border-teal-500 hover:text-teal-600",children:"開啟檔案中心"})]}),et?(0,t.jsx)("p",{className:"mt-3 text-sm text-slate-500",children:"檔案載入中…"}):Z.length?(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[eF&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"主照片"}),eF.downloadURL?(0,t.jsx)("button",{type:"button",onClick:()=>ej(eF),className:"mt-2 block",children:(0,t.jsx)("img",{src:eF.downloadURL,alt:eF.fileName,className:"max-h-64 w-full rounded-2xl object-contain cursor-zoom-in shadow-sm transition hover:shadow-lg"})}):(0,t.jsx)("div",{className:"mt-2 flex h-48 items-center justify-center rounded-2xl bg-slate-50 text-sm text-slate-500",children:"無法預覽此檔案"}),(0,t.jsx)("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:eF.title??eF.fileName}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:eF.mimeType})]}),eO.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-500",children:"其他附件"}),(0,t.jsx)("div",{className:"mt-2 grid gap-3 sm:grid-cols-2",children:eO.map(e=>(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-100 p-3 text-sm text-slate-600",children:[e.downloadURL&&e.mimeType.startsWith("image/")?(0,t.jsx)("button",{type:"button",onClick:()=>ej(e),className:"block",children:(0,t.jsx)("img",{src:e.downloadURL,alt:e.fileName,className:"h-40 w-full rounded-xl object-cover cursor-zoom-in shadow-sm transition hover:shadow-lg"})}):(0,t.jsx)("div",{className:"flex h-40 items-center justify-center rounded-xl bg-slate-50 text-xs text-slate-500",children:"無法預覽"}),(0,t.jsx)("p",{className:"mt-2 text-sm font-semibold text-slate-900",children:e.title??e.fileName}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:e.mimeType})]},e.id))})]})]}):(0,t.jsx)("p",{className:"mt-3 text-sm text-slate-500",children:"尚未上傳任何檔案。"})]})]})]})}),ef&&(0,t.jsx)("div",{className:"fixed inset-0 z-[70] flex items-center justify-center bg-slate-900/60 px-4 py-8",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-teal-600",children:"Preview"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:ef.title??ef.fileName}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:[ef.mimeType,ef.size?` \xb7 ${(ef.size/1024).toFixed(1)} KB`:""]})]}),(0,t.jsx)("button",{type:"button",onClick:()=>ej(null),className:"rounded-full px-3 py-1 text-sm text-slate-500 hover:bg-slate-100",children:"關閉"})]}),(0,t.jsx)("div",{className:"mt-4 rounded-2xl border border-slate-100 bg-slate-50 p-4",children:ef.downloadURL&&ef.mimeType.startsWith("image/")?(0,t.jsx)("img",{src:ef.downloadURL,alt:ef.fileName,className:"max-h-[70vh] w-full rounded-xl object-contain"}):(0,t.jsx)("div",{className:"flex h-64 items-center justify-center rounded-xl bg-slate-100 text-sm text-slate-500",children:"無法預覽此檔案，請至檔案中心下載檢視。"})})]})}),I&&(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 px-4 py-8",children:(0,t.jsxs)("div",{className:"w-full max-w-3xl max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-teal-600",children:V?"Edit":"Create"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:V?`編輯物料 ${E.code}`:"新增物料"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[V&&ew&&(0,t.jsx)("button",{type:"button",onClick:()=>{ei({title:"",description:"",tags:"",isPrimary:!1}),en(null),em(null),ep(null),er(!0)},className:"rounded-full border border-slate-200 px-3 py-1 text-sm font-semibold text-slate-700 hover:border-teal-500 hover:text-teal-600",children:"上傳檔案"}),(0,t.jsx)("button",{onClick:eU,className:"rounded-full px-3 py-1 text-sm text-slate-500 hover:bg-slate-100",children:"關閉"})]})]}),(0,t.jsxs)("form",{onSubmit:eV,className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"物料型態"}),(0,t.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:p.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>eA(e.value),disabled:!!V,className:`rounded-full px-4 py-2 text-sm font-semibold ${E.type===e.value?"bg-slate-900 text-white":"border border-slate-200 text-slate-600"} disabled:opacity-60`,children:e.label},e.value))})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["料號",(0,t.jsx)("input",{type:"text",value:E.code,onChange:e=>eW("code",e.target.value.toUpperCase()),readOnly:!!V||!H,className:`mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none ${V||!H?"bg-slate-100":""}`})]}),eK&&(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:H,onChange:e=>e$(e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-teal-600 focus:ring-teal-500"}),"使用萬用料號 (PS-0000A 可手動輸入)"]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["品名",(0,t.jsx)("input",{type:"text",value:E.name,onChange:e=>eW("name",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["規格",(0,t.jsx)("input",{type:"text",value:E.spec,onChange:e=>eW("spec",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["型號",(0,t.jsx)("input",{type:"text",value:E.model,onChange:e=>eW("model",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",placeholder:"例：BS-3X5"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["品牌",(0,t.jsxs)("select",{value:E.brandCode,onChange:e=>eW("brandCode",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"",children:"（未指定）"}),eD.map(e=>(0,t.jsxs)("option",{value:e.code,children:[e.name,e.countryCode?`｜${e.countryCode}`:""]},e.code))]})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["物料分類",(0,t.jsx)("select",{value:E.categoryCode,onChange:e=>eW("categoryCode",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:y.filter(e=>"active"===e.status).map(e=>(0,t.jsx)("option",{value:e.code,children:e.name},e.code))})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["計量單位",(0,t.jsx)("select",{value:E.unitCode,onChange:e=>eW("unitCode",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:v.map(e=>(0,t.jsxs)("option",{value:e.code,children:[e.code," ｜ ",e.name]},e.code))})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["預設倉庫",(0,t.jsxs)("select",{value:E.defaultWarehouseCode,onChange:e=>eW("defaultWarehouseCode",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"",children:"（未指定）"}),C.filter(e=>"active"===e.status).map(e=>(0,t.jsx)("option",{value:e.code,children:e.name},e.code))]})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["供應商",(0,t.jsxs)("select",{value:E.preferredSupplierCode,onChange:e=>eW("preferredSupplierCode",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"",children:"（未指定）"}),S.map(e=>(0,t.jsx)("option",{value:e.code,children:e.name},e.code))]})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["採購方式",(0,t.jsxs)("select",{value:E.purchaseMethodCode,onChange:e=>eW("purchaseMethodCode",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"",children:"（未指定）"}),ek.map(e=>(0,t.jsx)("option",{value:e.code,children:e.name},e.code))]})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["採購前置天數",(0,t.jsx)("input",{type:"number",min:0,value:E.purchaseLeadTimeDays,onChange:e=>eW("purchaseLeadTimeDays",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["參考成本",(0,t.jsx)("input",{type:"number",min:0,value:E.stdCost,onChange:e=>eW("stdCost",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["幣別",(0,t.jsx)("input",{type:"text",value:E.currency,onChange:e=>eW("currency",e.target.value.toUpperCase()),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",placeholder:"TWD / USD"})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["狀態",(0,t.jsxs)("select",{value:E.status,onChange:e=>eW("status",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"active",children:"使用中"}),(0,t.jsx)("option",{value:"inactive",children:"停用"})]})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:E.isStocked,onChange:e=>eW("isStocked",e.target.checked),className:"h-4 w-4 rounded border-slate-300 text-teal-600 focus:ring-teal-500"}),"納入庫存管控"]})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["說明及附件",(0,t.jsx)("textarea",{value:E.description,onChange:e=>eW("description",e.target.value),rows:3,className:"mt-1 w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",placeholder:"用途、附件說明或特殊注意事項"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["檢索用關鍵字",(0,t.jsx)("input",{type:"text",value:E.searchKeywords,onChange:e=>eW("searchKeywords",e.target.value),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",placeholder:"以逗號或空白分隔，例如：耐熱, 絕緣, 外銷"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"用於物料列表搜尋與關聯推薦。"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["備註",(0,t.jsx)("textarea",{value:E.note,onChange:e=>eW("note",e.target.value),rows:3,className:"mt-1 w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",placeholder:"例如：僅用於某專案、需特殊檢驗..."})]}),(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-100 bg-slate-50 px-4 py-3 text-sm text-slate-600",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-slate-400",children:"系統資訊"}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-4 text-xs text-slate-500",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-slate-600",children:"建碼人"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-slate-900",children:eX})]}),e_?.createdByUserId&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold text-slate-600",children:"建碼 UID"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:e_.createdByUserId})]})]})]}),_&&(0,t.jsx)("p",{className:"text-sm font-semibold text-red-600",children:_}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:eU,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600",children:"取消"}),(0,t.jsx)("button",{type:"submit",disabled:F,className:"rounded-full bg-teal-600 px-5 py-2 text-sm font-semibold text-white shadow-sm disabled:opacity-50",children:F?"儲存中…":V?"更新物料":"建立物料"})]})]})]})}),ed&&V&&(0,t.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-slate-900/50 px-4 py-8",children:(0,t.jsxs)("div",{className:"w-full max-w-xl max-h-[90vh] overflow-y-auto rounded-2xl bg-white p-6 shadow-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-teal-600",children:"Upload"}),(0,t.jsxs)("h2",{className:"text-xl font-semibold text-slate-900",children:["為 ",V," 上傳檔案"]}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"檔案會自動歸檔至檔案中心 · 物料模組"})]}),(0,t.jsx)("button",{onClick:eL,className:"rounded-full px-3 py-1 text-sm text-slate-500 hover:bg-slate-100",children:"關閉"})]}),(0,t.jsxs)("form",{onSubmit:eB,className:"mt-4 space-y-4",children:[(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["主檔編號",(0,t.jsx)("input",{type:"text",value:V,readOnly:!0,className:"mt-1 w-full rounded-xl border border-slate-200 bg-slate-100 px-4 py-2 text-sm"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["檔案標題（選填）",(0,t.jsx)("input",{type:"text",value:eo.title,onChange:e=>ei(t=>({...t,title:e.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["說明（選填）",(0,t.jsx)("textarea",{value:eo.description,onChange:e=>ei(t=>({...t,description:e.target.value})),rows:3,className:"mt-1 w-full rounded-2xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",placeholder:"輸入簡短說明以利辨識"})]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["標籤（以逗號或空白分隔）",(0,t.jsx)("input",{type:"text",value:eo.tags,onChange:e=>ei(t=>({...t,tags:e.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-slate-600",children:[(0,t.jsx)("input",{type:"checkbox",checked:eo.isPrimary,onChange:e=>ei(t=>({...t,isPrimary:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-teal-600 focus:ring-teal-500"}),"將第一個檔案設為主照片"]}),(0,t.jsxs)("label",{className:"block text-sm font-semibold text-slate-600",children:["選擇檔案",(0,t.jsx)("input",{type:"file",multiple:!0,onChange:e=>en(e.target.files),className:"mt-1 w-full text-sm"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"支援多檔同時上傳，建議單檔不超過 10MB。"})]}),ex&&(0,t.jsx)("p",{className:"text-sm font-semibold text-red-600",children:ex}),eu&&(0,t.jsx)("p",{className:"text-sm font-semibold text-emerald-600",children:eu}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:eL,className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600",children:"取消"}),(0,t.jsx)("button",{type:"submit",disabled:eh,className:"rounded-full bg-teal-600 px-5 py-2 text-sm font-semibold text-white shadow-sm disabled:opacity-50",children:eh?"上傳中…":"開始上傳"})]})]})]})}),(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-teal-600",children:"Materials"}),(0,t.jsx)("h1",{className:"text-2xl font-semibold text-slate-900",children:"物料主檔"}),(0,t.jsx)("p",{className:"text-sm text-slate-500",children:"零件與採購料的統一主檔，與 BOM、庫存、報價共用。"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)("button",{className:"rounded-full border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-700",children:"匯入清單"}),(0,t.jsx)("button",{onClick:()=>{R(null),J(!1),q(null),z(u(y[0]?.code)),A(!0),eI("PS")},disabled:!ev,className:"rounded-full bg-slate-900 px-4 py-2 text-sm font-semibold text-white disabled:bg-slate-400",children:"新增物料"})]})]}),X&&(0,t.jsx)("p",{className:"mt-4 rounded-xl bg-emerald-50 px-4 py-2 text-sm font-semibold text-emerald-700",children:X})]}),(0,t.jsx)("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),W(U)},className:"grid gap-4 rounded-2xl bg-slate-50/80 p-4 md:grid-cols-4",children:[(0,t.jsxs)("label",{className:"md:col-span-2",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"搜尋關鍵字"}),(0,t.jsx)("input",{type:"text",value:U.keyword,onChange:e=>B(t=>({...t,keyword:e.target.value})),placeholder:"料號 / 品名 / 規格",className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm focus:border-teal-500 focus:outline-none"})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"物料型態"}),(0,t.jsxs)("select",{value:U.type,onChange:e=>B(t=>({...t,type:e.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"全部型態"}),(0,t.jsx)("option",{value:"PS",children:"標準 (PS)"}),(0,t.jsx)("option",{value:"PM",children:"訂製 (PM)"}),(0,t.jsx)("option",{value:"PO",children:"其他 (PO)"})]})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"分類"}),(0,t.jsxs)("select",{value:U.category,onChange:e=>B(t=>({...t,category:e.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"全部分類"}),y.map(e=>(0,t.jsx)("option",{value:e.code,children:e.name},e.code))]})]}),(0,t.jsxs)("label",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-600",children:"狀態"}),(0,t.jsxs)("select",{value:U.status,onChange:e=>B(t=>({...t,status:e.target.value})),className:"mt-1 w-full rounded-xl border border-slate-200 bg-white px-4 py-2 text-sm focus:border-teal-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"全部狀態"}),(0,t.jsx)("option",{value:"active",children:"使用中"}),(0,t.jsx)("option",{value:"inactive",children:"停用"})]})]}),(0,t.jsxs)("div",{className:"flex items-end gap-2 md:col-span-4 md:justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{B(x),W(x)},className:"rounded-full border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-600",children:"重置"}),(0,t.jsx)("button",{type:"submit",className:"rounded-full bg-teal-600 px-5 py-2 text-sm font-semibold text-white shadow-sm",children:"套用篩選"})]})]})}),(0,t.jsxs)("div",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["已篩選 ",eT.length," 筆物料（共 ",f.length," 筆）"]})}),(0,t.jsx)("div",{className:"mt-4 overflow-x-auto rounded-xl border border-slate-100",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-slate-100 text-sm",children:[(0,t.jsx)("thead",{className:"bg-slate-50",children:(0,t.jsx)("tr",{children:["料號","品名 / 規格","型態","分類","單位","預設倉庫","狀態","操作"].map(e=>(0,t.jsx)("th",{className:"px-4 py-2 text-left text-xs font-semibold uppercase tracking-wide text-slate-500",children:e},e))})}),(0,t.jsx)("tbody",{className:"divide-y divide-slate-50",children:eT.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-slate-50/70",children:[(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3 font-semibold text-slate-900",children:e.code}),(0,t.jsxs)("td",{className:"px-4 py-3",children:[(0,t.jsx)("div",{className:"font-semibold text-slate-900",children:e.name}),(0,t.jsx)("div",{className:"text-xs text-slate-500",children:e.spec||"—"})]}),(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3",children:(0,t.jsx)("span",{className:"rounded-full bg-slate-900/10 px-3 py-1 text-xs font-semibold text-slate-700",children:e.type})}),(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3 text-slate-700",children:eR(e.categoryCode)}),(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3 text-slate-700",children:eE(e.unitCode)}),(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3 text-slate-700",children:ez(e.defaultWarehouseCode)}),(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3",children:(0,t.jsx)("span",{className:`rounded-full px-3 py-1 text-xs font-semibold ${"active"===e.status?"bg-emerald-50 text-emerald-700":"bg-slate-100 text-slate-500"}`,children:"active"===e.status?"使用中":"停用"})}),(0,t.jsx)("td",{className:"whitespace-nowrap px-4 py-3",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{Y(e),$(!0)},disabled:!eN,className:"rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 disabled:opacity-40",children:"檢視"}),(0,t.jsx)("button",{onClick:()=>{R(e.code),J(!1),z({code:e.code,name:e.name,spec:e.spec??"",model:e.model??"",brandCode:e.brandCode??"",type:e.type,categoryCode:e.categoryCode,unitCode:e.unitCode,defaultWarehouseCode:e.defaultWarehouseCode??"",preferredSupplierCode:e.preferredSupplierCode??"",purchaseMethodCode:e.purchaseMethodCode??"",purchaseLeadTimeDays:void 0!==e.purchaseLeadTimeDays?e.purchaseLeadTimeDays.toString():"",stdCost:void 0!==e.stdCost?e.stdCost.toString():"",currency:e.currency??"TWD",status:e.status,isStocked:e.isStocked,description:e.description??"",note:e.note??"",searchKeywords:e.searchKeywords?.join(" ")??""}),q(null),A(!0)},disabled:!eg,className:"rounded-full border border-slate-200 px-3 py-1 text-xs font-semibold text-slate-600 disabled:opacity-40",children:"編輯"}),"PM"===e.type&&!e.isVariant&&(0,t.jsx)("button",{type:"button",onClick:()=>{R(null),J(!1),q(null),z({code:e.code,name:`${e.name} 子料`,spec:e.spec??"",model:e.model??"",brandCode:e.brandCode??"",type:"PM",categoryCode:e.categoryCode,unitCode:e.unitCode,defaultWarehouseCode:e.defaultWarehouseCode??"",preferredSupplierCode:e.preferredSupplierCode??"",purchaseMethodCode:e.purchaseMethodCode??"",purchaseLeadTimeDays:void 0!==e.purchaseLeadTimeDays?e.purchaseLeadTimeDays.toString():"",stdCost:void 0!==e.stdCost?e.stdCost.toString():"",currency:e.currency??"TWD",status:"active",isStocked:!1,description:e.description??"",note:"",searchKeywords:e.searchKeywords?.join(" ")??"",baseCode:e.baseCode??e.code,isVariant:!0}),eM(e.baseCode??e.code),A(!0)},disabled:!ev,className:"rounded-full border border-teal-200 px-3 py-1 text-xs font-semibold text-teal-600 disabled:opacity-40",children:"建立子料"})]})})]},e.code))})]})})]})]})}e.s(["MaterialDirectory",()=>h])}]);