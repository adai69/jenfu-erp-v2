(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,47821,e=>{"use strict";e.s(["materialCategories",0,[{code:"MECH",name:"機構零件",type:"part",description:"焊接件、加工件、鈑金、鋼構等機械零件",status:"active",sortOrder:10},{code:"ELEC",name:"電控零件",type:"part",description:"電機、電控相關元件與線材",status:"active",sortOrder:20},{code:"CHEM",name:"藥劑耗材",type:"purchase",description:"藥劑、濾材、耗材等採購品",status:"active",sortOrder:30},{code:"STD",name:"標準件",type:"part",description:"螺絲、束帶、氣壓配件等標準採購件",status:"active",sortOrder:40},{code:"PACK",name:"包材 / 配件",type:"other",description:"包裝材料、工具、組裝配件",status:"active",sortOrder:50}],"materials",0,[{code:"PS-00001",name:"BS3X5 下軸承座",spec:"3X5mm, SS400+鍍鋅",type:"PS",categoryCode:"MECH",unitCode:"EA",defaultWarehouseCode:"WH-MAIN",preferredSupplierCode:"SUP0001",purchaseLeadTimeDays:12,stdCost:4500,currency:"TWD",status:"active",isStocked:!0,note:"標準採購件，適用油水分離機 BS 系列",isVariant:!1},{code:"PM-00001",name:"絞爪 3X5-2 用",spec:"2mm, 客製長 780mm",type:"PM",categoryCode:"MECH",unitCode:"EA",defaultWarehouseCode:"WH-WIP",preferredSupplierCode:"SUP0002",purchaseLeadTimeDays:20,status:"active",isStocked:!1,note:"訂製件，目前僅供案號 2025-BS-021 使用",baseCode:"PM-00001",isVariant:!1},{code:"PO-00001",name:"除油劑 A 配方",spec:"液態 25L/桶",type:"PO",categoryCode:"CHEM",unitCode:"L",defaultWarehouseCode:"WH-MAT",preferredSupplierCode:"SUP0003",purchaseLeadTimeDays:15,stdCost:1800,currency:"TWD",status:"active",isStocked:!0,note:"採購品，需低溫存放",isVariant:!1},{code:"PM-00001-00001",name:"絞爪 3X5-2 客製尺寸 1",spec:"2mm, 客製長 820mm",type:"PM",categoryCode:"MECH",unitCode:"EA",defaultWarehouseCode:"WH-WIP",preferredSupplierCode:"SUP0002",purchaseLeadTimeDays:20,status:"active",isStocked:!1,baseCode:"PM-00001",variantNo:"00001",isVariant:!0,note:"PM-00001 子料，案號 2025-BS-021 變形 A"}],"paymentTerms",0,[{code:"NET30",name:"貨到 30 天內付款",category:"net",netDays:30,status:"active",description:"出貨日 + 30 天付款",sortOrder:10},{code:"MONTH30",name:"月結 30 天",category:"monthly",monthlyOffset:30,status:"active",description:"每月月底結算，次月 30 日付款",sortOrder:20},{code:"COD",name:"貨到付現",category:"cash",status:"active",description:"交貨時付款",sortOrder:30},{code:"PREPAY30_70",name:"預付30%＋尾款70%",category:"installment",status:"active",description:"下單預付30%，出貨前付清剩餘70%",sortOrder:40},{code:"ON_HOLD",name:"暫停付款條款",category:"installment",status:"inactive",description:"僅留存紀錄，不提供新單據使用",sortOrder:90}],"sequences",0,[{key:"QUOTE",prefix:"QU",padding:4,nextNumber:128,scope:"報價"},{key:"ORDER",prefix:"SO",padding:5,nextNumber:3021,scope:"訂單"},{key:"WO",prefix:"WO",padding:5,nextNumber:873,scope:"製令"},{key:"SERIAL",prefix:"CFM",padding:6,nextNumber:54219,scope:"序號"},{key:"USER",prefix:"UA",padding:4,nextNumber:2,scope:"帳號"},{key:"EMPLOYEE",prefix:"JFS",padding:4,nextNumber:16,scope:"員工"},{key:"PART_PS",prefix:"PS-",padding:5,nextNumber:1,scope:"帳號"},{key:"PART_PM",prefix:"PM-",padding:5,nextNumber:1,scope:"帳號"},{key:"PART_PO",prefix:"PO-",padding:5,nextNumber:1,scope:"帳號"},{key:"SUPPLIER",prefix:"SUP",padding:4,nextNumber:4,scope:"帳號"}],"suppliers",0,[{code:"SUP0001",name:"亞鋼金屬",contact:"陳小姐",phone:"02-1234-5678",level:"A",leadTimeDays:12,status:"active",email:"sales@acm.com.tw",address:"台中市大肚區工業路 100 號",paymentTermCode:"MONTH30",taxId:"12345678",note:"主要供應 SS 板材"},{code:"SUP0002",name:"鑫泉幫浦",contact:"吳經理",phone:"04-8765-4321",level:"A",leadTimeDays:20,status:"active",email:"service@pump.com.tw",paymentTermCode:"NET30"},{code:"SUP0003",name:"沛富化工原料",contact:"林先生",phone:"07-2222-8888",level:"B",leadTimeDays:15,status:"suspended",note:"僅供偶爾訂單使用"}],"units",0,[{code:"EA",name:"台",category:"count",conversion:"1 台 = 1 件"},{code:"SET",name:"套",category:"count",conversion:"1 套 = 多件零組"},{code:"BAR",name:"條",category:"count",conversion:"1 條 = 1 件"},{code:"KG",name:"公斤",category:"weight",conversion:"1 kg = 1000 g"},{code:"L",name:"公升",category:"volume",conversion:"1 L = 1000 mL"},{code:"MM",name:"毫米",category:"length",conversion:"1 mm = 0.001 m"},{code:"LPM",name:"公升/分鐘",category:"flow",conversion:"1 LPM = 0.001 m³/min"},{code:"M3H",name:"立方米/小時",category:"flow",conversion:"1 m³/h = 16.67 LPM"},{code:"DEG-C",name:"攝氏度",category:"temperature",conversion:"基準溫標 °C"},{code:"DEG-F",name:"華氏度",category:"temperature",conversion:"°F = °C × 1.8 + 32"}],"warehouses",0,[{code:"WH-MAIN",name:"主倉",type:"raw",status:"active",isDefaultReceive:!0,isDefaultIssue:!0,sortOrder:10,address:"台中大肚廠內一樓",note:"零件材料主要存放區"},{code:"WH-MAT",name:"材料倉",type:"raw",status:"active",sortOrder:20,address:"台中大肚廠內二樓",note:"板金 / 型材 / 標準件"},{code:"WH-FG",name:"成品倉",type:"fg",status:"active",sortOrder:30,address:"台中大肚廠外成品棚"},{code:"WH-WIP",name:"組裝暫存區",type:"wip",status:"active",sortOrder:40,note:"組裝工位旁暫存架"},{code:"WH-OUT-TC",name:"外包倉-台中",type:"other",status:"active",sortOrder:50,note:"外包加工廠暫存"}]])},84616,43873,78598,e=>{"use strict";var t=e.i(71645);e.s(["DEPARTMENT_DEFINITIONS",0,{executive:{label:"經營",description:"決策／策略"},rd:{label:"研發",description:"產品與設計"},production:{label:"生產",description:"製造與現場"},sales:{label:"營銷",description:"業務與客服"},management:{label:"管理",description:"行政／管理"},finance:{label:"財務",description:"財會／稽核"}},"ROLE_DEFINITIONS",0,{admin:{label:"Admin",description:"序號調整、審核、最高權限",hierarchy:4},manager:{label:"Manager",description:"日常維運與審核啟動",hierarchy:3},planner:{label:"Planner",description:"草稿建立、流程規劃",hierarchy:2},operator:{label:"Operator",description:"查詢與執行現場作業",hierarchy:1}}],43873);let r={users:{label:"使用者",description:"帳號與權限"},employees:{label:"員工",description:"人事資料卡"},units:{label:"計量單位",description:"跨模組基本單位"},suppliers:{label:"供應商",description:"採購夥伴"},customers:{label:"客戶",description:"營銷對象"},parts:{label:"零件",description:"料號與成本"},products:{label:"產品",description:"BOM 與模組"},categories:{label:"類別",description:"物料分類"},files:{label:"檔案中心",description:"設計圖 / 圖片 / 附件"},sequences:{label:"序號",description:"Prefix / 流水"},quotes:{label:"報價",description:"報價單與交期"},orders:{label:"訂單",description:"接單與變更"},inventory:{label:"庫存",description:"入出庫與盤點"},production:{label:"產品/製令",description:"工單與製造履歷"},materials:{label:"物料",description:"零件與採購料主檔"}},a={view:"檢視",create:"新增",update:"編輯",disable:"停用",approve:"核准",lock:"鎖定","sequence-adjust":"調整序號",cancel:"作廢"},i={admin:{users:["view","create","update","disable","approve"],employees:["view","create","update","disable"],units:["view","create","update","disable","approve"],suppliers:["view","create","update","disable","approve"],customers:["view","create","update","disable","approve"],parts:["view","create","update","disable","approve"],products:["view","create","update","disable","approve"],categories:["view","create","update","disable","approve"],sequences:["view","lock","sequence-adjust","approve"],quotes:["view","create","update","approve","lock","cancel"],orders:["view","create","update","approve","lock","cancel"],inventory:["view","create","update","lock"],production:["view","create","update","approve","lock"],materials:["view","create","update","disable"],files:["view","create","update","disable"]},manager:{users:["view","create","update","disable"],employees:["view","create","update"],units:["view","create","update","disable"],suppliers:["view","create","update"],customers:["view","create","update"],parts:["view","create","update","disable"],products:["view","create","update"],categories:["view","create","update"],sequences:["view","lock"],quotes:["view","create","update","lock"],orders:["view","create","update","lock"],inventory:["view","create","update"],production:["view","create","update"],materials:["view","create","update"],files:["view","create","update"]},planner:{users:["view"],employees:["view","create"],units:["view","create"],suppliers:["view","create"],customers:["view","create"],parts:["view","create"],products:["view","create"],categories:["view","create"],sequences:["view"],quotes:["view","create"],orders:["view","create"],inventory:["view","create"],production:["view","create"],materials:["view","create"],files:["view","create"]},operator:{users:["view"],employees:["view"],units:["view"],suppliers:["view"],customers:["view"],parts:["view"],products:["view"],categories:["view"],sequences:["view"],quotes:["view"],orders:["view"],inventory:["view"],production:["view"],materials:["view"],files:["view"]}};function s(e,t){let r={users:[],employees:[],units:[],suppliers:[],customers:[],parts:[],products:[],categories:[],materials:[],files:[],sequences:[],quotes:[],orders:[],inventory:[],production:[]},{roleFilter:a,departmentFilter:s}=t??{},o=e.filter(e=>{let t=!a||e.role===a,r=!s||!e.departments.length||e.departments.includes(s);return t&&r});if(!o.length)return r;for(let e of o)Object.entries(i[e.role]).forEach(([e,t])=>{let a=new Set(r[e]);t.forEach(e=>a.add(e)),r[e]=Array.from(a)});return r}function o(e,t,r,a){let i=s(e,a);return i[t]?.includes(r)??!1}e.s(["ACTION_LABELS",()=>a,"MODULE_DEFINITIONS",()=>r,"buildPermissionProfile",()=>s,"canPerformAction",()=>o],78598);var c=e.i(57951);function n(e){let{assignments:r,roleFilter:a,departmentFilter:i}=e??{},{claims:n}=(0,c.useAuth)(),d=!!(r&&r.length),p=(0,t.useMemo)(()=>{if(!n?.roles?.length)return[];let e=n.departments??[];return n.roles.map(t=>({role:t,departments:e}))},[n?.departments,n?.roles]),u=(0,t.useMemo)(()=>{if(d&&r)return s(r,{roleFilter:a,departmentFilter:i});let e=n?.modules;if(e){let t=s(p,{roleFilter:a,departmentFilter:i});return Object.keys(t).forEach(r=>{let a=e[r];Array.isArray(a)&&(t[r]=a)}),t}return p.length?s(p,{roleFilter:a,departmentFilter:i}):null},[r,n?.modules,i,p,a,d]);return{profile:u,can:(e,t)=>{if(d&&r)return o(r,e,t,{roleFilter:a,departmentFilter:i});let s=u?.[e];return!!Array.isArray(s)&&s.includes(t)}}}e.s(["usePermission",()=>n],84616)},27379,e=>{"use strict";e.i(36180);var t=e.i(98925),r=e.i(74503);let a=new Map(e.i(47821).sequences.map(e=>[e.key,{...e}])),i=(0,t.collection)(r.db,"sequences");async function s(e){let s=a.get(e);if(!s)throw Error(`Sequence ${e} not found`);let o=await (0,t.runTransaction)(r.db,async r=>{let a=(0,t.doc)(i,e),o=await r.get(a),c={prefix:s.prefix,padding:s.padding,nextNumber:s.nextNumber};o.exists()&&(c=o.data());let n=`${c.prefix}${c.nextNumber.toString().padStart(c.padding,"0")}`;return r.set(a,{prefix:c.prefix,padding:c.padding,nextNumber:c.nextNumber+1},{merge:!0}),{value:n,issuedNumber:c.nextNumber}});return s.nextNumber=o.issuedNumber+1,{key:e,value:o.value,issuedNumber:o.issuedNumber}}e.s(["issueSequence",()=>s])},9348,e=>{"use strict";e.i(36180);var t=e.i(98925);e.i(61086);var r=e.i(27215),a=e.i(74503);async function i(e,r,i){let s=(await (0,t.getDocs)((0,t.query)((0,t.collection)(a.db,"files"),(0,t.where)("targetModule","==",e),(0,t.where)("entityId","==",r),(0,t.where)("isPrimary","==",!0)))).docs.filter(e=>e.id!==i).map(e=>(0,t.updateDoc)(e.ref,{isPrimary:!1}));await Promise.all(s)}async function s({module:e,entityId:s,files:o,metadata:c,createdBy:n}){if(!s.trim()||0===o.length)throw Error("entityId 和 files 為必填");let d=s.trim(),p=c?.title?.trim(),u=c?.description?.trim(),l=c?.tags?.filter(e=>e.trim())??[];c?.setPrimary&&await i(e,d);for(let i=0;i<o.length;i+=1){let s=o[i],m=`${e}/${d}/${Date.now()}-${s.name}`;await (0,r.uploadBytes)((0,r.ref)(a.storage,m),s),await (0,t.addDoc)((0,t.collection)(a.db,"files"),{targetModule:e,entityId:d,storagePath:m,fileName:s.name,mimeType:s.type||"application/octet-stream",size:s.size,title:p||s.name,description:u||null,tags:l,isPrimary:!!c?.setPrimary&&0===i,orderIndex:Date.now()+i,createdAt:(0,t.serverTimestamp)(),createdByUid:n?.uid??null,createdByName:n?.name??"system"})}}e.s(["clearExistingPrimary",()=>i,"uploadFilesForEntity",()=>s])}]);